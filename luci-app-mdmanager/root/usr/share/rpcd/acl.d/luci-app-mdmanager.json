{
	"luci-app-mdmanager": {
		"description": "Grant access to Mini Disk Manager",
		"read": {
			"ubus": {
				"diskmanager": [
					"check_operation",
					"list"
				]
			},
			"cgi-io": ["exec"],
			"file": {
				"/dev": ["list"],
				"/proc/mounts": ["read"],
				"/proc/partitions": ["read"],
				"/sys/block/*/device/model": ["read"],
				"/sys/block/*/device/rescan": ["read", "write"],
				"/tmp/diskmanager.pid": ["read"],
				"/tmp/diskmanager.result": ["read"],
				"/tmp/diskmanager.log": ["read"],
				"/tmp/diskop.pid": ["read"],
				"/tmp/diskop.result": ["read"],
				"/tmp/diskop.log": ["read"],

				"/usr/bin/lsblk -J -b -o NAME,SIZE,TYPE,FSTYPE,MOUNTPOINT,MODEL /dev/*": ["exec"],
				"/usr/bin/lsblk -J -b -o NAME,SIZE,TYPE,FSTYPE,MOUNTPOINT,LABEL,UUID,PARTTYPENAME /dev/*": ["exec"],
				"/usr/bin/lsblk -dno MODEL /dev/*": ["exec"],
				"/usr/sbin/fdisk -l /dev/*": ["exec"],

				"/sbin/parted /dev/* unit B print free": ["exec"],
				"/sbin/parted -s /dev/* print": ["exec"],
				"/sbin/parted -s /dev/* unit s print": ["exec"],
				"/sbin/parted -s /dev/* unit s print free": ["exec"],
				"/sbin/parted -s -m /dev/* print": ["exec"],
				"/sbin/parted -s -m /dev/* unit s print": ["exec"],
				"/sbin/parted -s -m /dev/* unit s print free": ["exec"],

				"/usr/sbin/blkid -s TYPE -o value /dev/*": ["exec"],
				"/bin/df -h *": ["exec"],
				"/bin/df -B1 *": ["exec"],
				"/bin/mount": ["exec"],

				"/usr/sbin/smartctl -iAHl scttemp -l error -l devstat --json=c /dev/*": ["exec"],
				"/usr/sbin/smartctl -l scttempint,[0-9,p]* /dev/*": ["exec"],
				"/usr/sbin/smartctl -A /dev/*": ["exec"],
				"/usr/sbin/smartctl -H /dev/*": ["exec"],
				
				"/usr/libexec/package-manager-call list-installed": [ "exec" ],
				"/usr/libexec/opkg-list installed": [ "exec" ],
				"/usr/libexec/opkg-call list-installed": [ "exec" ]
			}
		},
		"write": {
			"ubus": {
				"diskmanager": [
					"create_partition",
					"delete_partition",
					"format_partition"
				]
			},
			"cgi-io": ["exec"],
			"file": {
				"/sys/block/*/device/rescan": ["write"],
				"/tmp/diskmanager.pid": ["write"],
				"/tmp/diskmanager.result": ["write"],
				"/tmp/diskmanager.log": ["write"],

				"/sbin/parted /dev/* mklabel *": ["exec"],
				"/sbin/parted /dev/* mkpart *": ["exec"],
				"/sbin/parted /dev/* rm *": ["exec"],

				"/sbin/parted -s /dev/* mklabel *": ["exec"],
				"/sbin/parted -s /dev/* mkpart *": ["exec"],
				"/sbin/parted -s /dev/* rm *": ["exec"],

				"/sbin/parted -s -m /dev/* mklabel *": ["exec"],
				"/sbin/parted -s -m /dev/* mkpart *": ["exec"],
				"/sbin/parted -s -m /dev/* rm *": ["exec"],

				"/sbin/partprobe /dev/*": ["exec"],
				"/sbin/blockdev --rereadpt /dev/*": ["exec"],

				"/usr/sbin/mkfs.ext4 *": ["exec"],
				"/usr/sbin/mkfs.ext3 *": ["exec"],
				"/usr/sbin/mkfs.ext2 *": ["exec"],
				"/usr/sbin/mkfs.f2fs *": ["exec"],
				"/usr/sbin/mkfs.ntfs *": ["exec"],
				"/usr/sbin/mkfs.fat *": ["exec"],
				"/usr/sbin/mkfs.exfat *": ["exec"],
				"/usr/sbin/mkswap *": ["exec"],

				"/bin/dd *": ["exec"],
				"/bin/sync": ["exec"],
				"/bin/mount *": ["exec"],
				"/bin/umount *": ["exec"],
				"/bin/umount -l *": ["exec"],
				"/bin/umount -f *": ["exec"],
				"/bin/mkdir *": ["exec"]
			}
		}
	}
}
